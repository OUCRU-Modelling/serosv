---
title: "Imperfect serological test"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Imperfect serological test}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, output=FALSE}
library(serosv)
```

## Imperfect test

Function `correct_prevalence()` is used for estimating the true prevalence if the serological test used is imperfect

```{r}
# estimate real prevalence
data <- rubella_uk_1986_1987
output <- correct_prevalence(data$age, pos = data$pos, tot = data$tot, warmup = 1000, iter = 4000, study_size=1000)

# check fitted value
output$info

# compare original prevalence and corrected prevalence
ggplot()+
  geom_point(aes(x = data$age, y = data$pos/data$tot), color="royalblue1") + 
  geom_point(aes(x = output$corrected_se$age, y = output$corrected_se$sero), color="blueviolet")
```
