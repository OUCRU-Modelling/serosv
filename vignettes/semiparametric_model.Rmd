---
title: "Semiparametric model"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Semiparametric model}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, output=FALSE}
library(serosv)
```

## Penalized splines

### Penalized likelihood framework

Refer to Chapter `8.2.1`

```{r}
data <- parvob19_be_2001_2003
ps <- penalized_spline_model(data$age, data$seropositive, s = "tp", framework = "ps") 
ps$info
```

```{r}
plot(ps)
```

### Generalized Linear Mixture Model framework

Refer to Chapter `8.2.2`

```{r}
data <- parvob19_be_2001_2003
glmm <- penalized_spline_model(data$age, data$seropositive, s = "tp", framework = "glmm") 
glmm$info$gam
```

```{r}
plot(glmm)
```

## Adaptive spline smoothing

Refer to chapter `8.4`

*Work in progress*
