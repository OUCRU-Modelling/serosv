# serosv

`serosv` is an easy-to-use and efficient tool to estimate infectious
diseases parameters (seroprevalence and force of infection) using
serological data. The current version is mostly based on the book
“Modeling Infectious Disease Parameters Based on Serological and Social
Contact Data – A Modern Statistical Perspective” by [Hens et al., 2012
Springer](https://link.springer.com/book/10.1007/978-1-4614-4072-7).

## Installation

You can install the development version of serosv with:

``` r
# install.packages("devtools")
devtools::install_github("OUCRU-Modelling/serosv")
```

## Feature overview

### Datasets

`serosv` contains 15 built-in serological datasets as provided by [Hens
et al., 2012
Springer](https://link.springer.com/book/10.1007/978-1-4614-4072-7).
Simply call the name to load a dataset, for example:

``` r
rubella <- rubella_uk_1986_1987
```

### Methods

The following methods are available to estimate seroprevalence and force
of infection.

Parametric approaches:

- Frequentist methods:

  - Polynomial models:

    - Muench’s model
    - Griffiths’ model
    - Grenfell and Anderson’s model

  - Nonlinear models:

    - Farrington’s model
    - Weibull model

  - Fractional polynomial models

- Bayesian methods:

  - Hierarchical Farrington model

  - Hierarchical log-logistic model

Nonparametric approaches:

- Local estimation by polynomials

Semiparametric approaches:

- Penalized splines:

  - Penalized likelihood framework

  - Generalized Linear Mixed Model framework

## Demo

### Fitting rubella data from the UK

Load the rubella in UK dataset.

``` r
library(serosv)
```

Find the power for the best second degree fractional polynomial with
monotonicity constraint and a logit link function. The power appears to
be (-0.9,-0.9).

``` r
rubella <- rubella_uk_1986_1987

best_2d_mn <- find_best_fp_powers(
  rubella,
  p=seq(-2,3,0.1), mc = T, degree=2, link="logit"
)

best_2d_mn
#> $p
#> [1] -0.9 -0.9
#> 
#> $deviance
#> [1] 37.57966
#> 
#> $model
#> 
#> Call:  glm(formula = as.formula(formulate(p_cur)), family = binomial(link = link))
#> 
#> Coefficients:
#>               (Intercept)                I(age^-0.9)  
#>                     4.342                     -4.696  
#> I(I(age^-0.9) * log(age))  
#>                    -9.845  
#> 
#> Degrees of Freedom: 43 Total (i.e. Null);  41 Residual
#> Null Deviance:       1369 
#> Residual Deviance: 37.58     AIC: 210.1
```

Finally, fit the second degree fractional polynomial.

``` r
fpmd <- fp_model(
  rubella,
  p=c(-0.9, -0.9), link="logit")

plot(fpmd)
```

![](reference/figures/README-unnamed-chunk-5-1.png)

### Fitting Parvo B19 data from Finland

``` r
library(dplyr)
#> Warning: package 'dplyr' was built under R version 4.3.1
#> 
#> Attaching package: 'dplyr'
#> The following objects are masked from 'package:stats':
#> 
#>     filter, lag
#> The following objects are masked from 'package:base':
#> 
#>     intersect, setdiff, setequal, union
parvob19 <- parvob19_fi_1997_1998

# for linelisting data, either transform it to aggregated
transform_data(
  parvob19$age, 
  parvob19$seropositive,
  stratum_col = "age") |>
  polynomial_model(type = "Muench") |>
  plot()
```

![](reference/figures/README-unnamed-chunk-6-1.png)

``` r

# or fit data as is
parvob19 |>
  rename(status = seropositive) |>
  polynomial_model(type = "Muench") |>
  plot()
```

![](reference/figures/README-unnamed-chunk-6-2.png)

# Package index

## Dataset

### Hepatitis A

- [`hav_be_1993_1994`](https://oucru-modelling.github.io/serosv/reference/hav_be_1993_1994.md)
  : Hepatitis A serological data from Belgium in 1993 and 1994
  (aggregated)
- [`hav_be_2002`](https://oucru-modelling.github.io/serosv/reference/hav_be_2002.md)
  : Hepatitis A serological data from Belgium in 2002 (line listing)
- [`hav_bg_1964`](https://oucru-modelling.github.io/serosv/reference/hav_bg_1964.md)
  : Hepatitis A serological data from Bulgaria in 1964 (aggregated)

### Hepatitis B

- [`hbv_ru_1999`](https://oucru-modelling.github.io/serosv/reference/hbv_ru_1999.md)
  : Hepatitis B serological data from Russia in 1999 (aggregated)

### Hepatitis C

- [`hcv_be_2006`](https://oucru-modelling.github.io/serosv/reference/hcv_be_2006.md)
  : Hepatitis C serological data from Belgium in 2006 (line listing)

### Mumps

- [`mumps_uk_1986_1987`](https://oucru-modelling.github.io/serosv/reference/mumps_uk_1986_1987.md)
  : Mumps serological data from the UK in 1986 and 1987 (aggregated)

### Parvo B19

- [`parvob19_be_2001_2003`](https://oucru-modelling.github.io/serosv/reference/parvob19_be_2001_2003.md)
  : Parvo B19 serological data from Belgium from 2001-2003 (line
  listing)
- [`parvob19_ew_1996`](https://oucru-modelling.github.io/serosv/reference/parvob19_ew_1996.md)
  : Parvo B19 serological data from England and Wales in 1996 (line
  listing)
- [`parvob19_fi_1997_1998`](https://oucru-modelling.github.io/serosv/reference/parvob19_fi_1997_1998.md)
  : Parvo B19 serological data from Finland from 1997-1998 (line
  listing)
- [`parvob19_it_2003_2004`](https://oucru-modelling.github.io/serosv/reference/parvob19_it_2003_2004.md)
  : Parvo B19 serological data from Italy from 2003-2004 (line listing)
- [`parvob19_pl_1995_2004`](https://oucru-modelling.github.io/serosv/reference/parvob19_pl_1995_2004.md)
  : Parvo B19 serological data from Poland from 1995-2004 (line listing)

### Rubella

- [`rubella_uk_1986_1987`](https://oucru-modelling.github.io/serosv/reference/rubella_uk_1986_1987.md)
  : Rubella serological data from the UK in 1986 and 1987 (aggregated)

### Tuberculosis

- [`tb_nl_1966_1973`](https://oucru-modelling.github.io/serosv/reference/tb_nl_1966_1973.md)
  : Tuberculosis serological data from the Netherlands 1966-1973
  (aggregated)

### VZV

- [`vzv_be_1999_2000`](https://oucru-modelling.github.io/serosv/reference/vzv_be_1999_2000.md)
  : VZV serological data from Belgium (Flanders) from 1999-2000
  (aggregated)
- [`vzv_be_2001_2003`](https://oucru-modelling.github.io/serosv/reference/vzv_be_2001_2003.md)
  : VZV serological data from Belgium from 2001-2003 (line listing)

### Multivariate data

- [`rubella_mumps_uk`](https://oucru-modelling.github.io/serosv/reference/rubella_mumps_uk.md)
  : Rubella - Mumps data from the UK (aggregated)
- [`vzv_parvo_be`](https://oucru-modelling.github.io/serosv/reference/vzv_parvo_be.md)
  : VZV and Parvovirus B19 serological data in Belgium (line listing)

## Models

- [`sir_basic_model()`](https://oucru-modelling.github.io/serosv/reference/sir_basic_model.md)
  : Basic SIR model
- [`sir_static_model()`](https://oucru-modelling.github.io/serosv/reference/sir_static_model.md)
  : SIR static model (age-heterogeneous, endemic equilibrium)
- [`sir_subpops_model()`](https://oucru-modelling.github.io/serosv/reference/sir_subpops_model.md)
  : SIR Model with Interacting Subpopulations
- [`mseir_model()`](https://oucru-modelling.github.io/serosv/reference/mseir_model.md)
  : MSEIR model
- [`polynomial_model()`](https://oucru-modelling.github.io/serosv/reference/polynomial_model.md)
  : Polynomial models
- [`farrington_model()`](https://oucru-modelling.github.io/serosv/reference/farrington_model.md)
  : The Farrington (1990) model.
- [`weibull_model()`](https://oucru-modelling.github.io/serosv/reference/weibull_model.md)
  : The Weibull model.
- [`fp_model()`](https://oucru-modelling.github.io/serosv/reference/fp_model.md)
  : A fractional polynomial model.
- [`lp_model()`](https://oucru-modelling.github.io/serosv/reference/lp_model.md)
  : A local polynomial model.
- [`hierarchical_bayesian_model()`](https://oucru-modelling.github.io/serosv/reference/hierarchical_bayesian_model.md)
  : Hierarchical Bayesian Model
- [`penalized_spline_model()`](https://oucru-modelling.github.io/serosv/reference/penalized_spline_model.md)
  : Penalized Spline model
- [`mixture_model()`](https://oucru-modelling.github.io/serosv/reference/mixture_model.md)
  : Fit a mixture model to classify serostatus
- [`estimate_from_mixture()`](https://oucru-modelling.github.io/serosv/reference/estimate_from_mixture.md)
  : Estimate seroprevalence and foi by combining mixture model and
  regression
- [`age_time_model()`](https://oucru-modelling.github.io/serosv/reference/age_time_model.md)
  : Age-time varying seroprevalence

## Plotting functions

- [`plot_corrected_prev()`](https://oucru-modelling.github.io/serosv/reference/plot_corrected_prev.md)
  : Plot output for corrected_prevalence
- [`plot_standard_curve()`](https://oucru-modelling.github.io/serosv/reference/plot_standard_curve.md)
  : Visualize standard curves for each plate
- [`plot_titer_qc()`](https://oucru-modelling.github.io/serosv/reference/plot_titer_qc.md)
  : Quality control plot
- [`plot_gcv()`](https://oucru-modelling.github.io/serosv/reference/plot_gcv.md)
  : Plotting GCV values with respect to different nn-s and h-s
  parameters.
- [`plot(`*`<polynomial_model>`*`)`](https://oucru-modelling.github.io/serosv/reference/plot.polynomial_model.md)
  : plot() overloading for polynomial model
- [`plot(`*`<farrington_model>`*`)`](https://oucru-modelling.github.io/serosv/reference/plot.farrington_model.md)
  : plot() overloading for Farrington model
- [`plot(`*`<weibull_model>`*`)`](https://oucru-modelling.github.io/serosv/reference/plot.weibull_model.md)
  : plot() overloading for Weibull model
- [`plot(`*`<fp_model>`*`)`](https://oucru-modelling.github.io/serosv/reference/plot.fp_model.md)
  : plot() overloading for fractional polynomial model
- [`plot(`*`<lp_model>`*`)`](https://oucru-modelling.github.io/serosv/reference/plot.lp_model.md)
  : plot() overloading for local polynomial model
- [`plot(`*`<mseir_model>`*`)`](https://oucru-modelling.github.io/serosv/reference/plot.mseir_model.md)
  : plot() overloading for MSEIR model
- [`plot(`*`<sir_basic_model>`*`)`](https://oucru-modelling.github.io/serosv/reference/plot.sir_basic_model.md)
  : plot() overloading for SIR model
- [`plot(`*`<sir_static_model>`*`)`](https://oucru-modelling.github.io/serosv/reference/plot.sir_static_model.md)
  : plot() overloading for SIR static model
- [`plot(`*`<sir_subpops_model>`*`)`](https://oucru-modelling.github.io/serosv/reference/plot.sir_subpops_model.md)
  : plot() overloading for SIR sub populations model
- [`plot(`*`<hierarchical_bayesian_model>`*`)`](https://oucru-modelling.github.io/serosv/reference/plot.hierarchical_bayesian_model.md)
  : plot() overloading for hierarchical_bayesian_model
- [`plot(`*`<penalized_spline_model>`*`)`](https://oucru-modelling.github.io/serosv/reference/plot.penalized_spline_model.md)
  : plot() overloading for penalized spline
- [`plot(`*`<mixture_model>`*`)`](https://oucru-modelling.github.io/serosv/reference/plot.mixture_model.md)
  : plot() overloading for mixture model
- [`plot(`*`<estimate_from_mixture>`*`)`](https://oucru-modelling.github.io/serosv/reference/plot.estimate_from_mixture.md)
  : plot() overloading for result of estimate_from_mixture
- [`plot(`*`<age_time_model>`*`)`](https://oucru-modelling.github.io/serosv/reference/plot.age_time_model.md)
  : Plot output for age_time_model
- [`set_plot_style()`](https://oucru-modelling.github.io/serosv/reference/set_plot_style.md)
  : Helper to adjust styling of a plot
- [`add_thresholds()`](https://oucru-modelling.github.io/serosv/reference/add_thresholds.md)
  : Visualize positive threshold at different dilution factors

## Other utilities

- [`serosv`](https://oucru-modelling.github.io/serosv/reference/serosv-package.md)
  [`serosv-package`](https://oucru-modelling.github.io/serosv/reference/serosv-package.md)
  : serosv: model infectious disease parameters
- [`est_foi()`](https://oucru-modelling.github.io/serosv/reference/est_foi.md)
  : Estimate force of infection
- [`pava()`](https://oucru-modelling.github.io/serosv/reference/pava.md)
  : Monotonize seroprevalence
- [`to_titer()`](https://oucru-modelling.github.io/serosv/reference/to_titer.md)
  : Process assay test result to titer
- [`correct_prevalence()`](https://oucru-modelling.github.io/serosv/reference/correct_prevalence.md)
  : Estimate the true sero prevalence using Frequentist/Bayesian
  estimation
- [`transform_data()`](https://oucru-modelling.github.io/serosv/reference/transform_data.md)
  : Aggregate data
- [`standardize_data()`](https://oucru-modelling.github.io/serosv/reference/standardize_data.md)
  : Preprocess data
- [`compare_models()`](https://oucru-modelling.github.io/serosv/reference/compare_models.md)
  : Compare models
- [`compute_ci()`](https://oucru-modelling.github.io/serosv/reference/compute_ci.md)
  : Compute confidence interval
- [`compute_ci.fp_model()`](https://oucru-modelling.github.io/serosv/reference/compute_ci.fp_model.md)
  : Compute confidence interval for fractional polynomial model
- [`compute_ci.lp_model()`](https://oucru-modelling.github.io/serosv/reference/compute_ci.lp_model.md)
  : Compute confidence interval for local polynomial model
- [`compute_ci.weibull_model()`](https://oucru-modelling.github.io/serosv/reference/compute_ci.weibull_model.md)
  : Compute confidence interval for Weibull model
- [`compute_ci.penalized_spline_model()`](https://oucru-modelling.github.io/serosv/reference/compute_ci.penalized_spline_model.md)
  : Compute confidence interval for penalized_spline_model
- [`compute_ci.mixture_model()`](https://oucru-modelling.github.io/serosv/reference/compute_ci.mixture_model.md)
  : Compute confidence interval for mixture model
- [`compute_ci.age_time_model()`](https://oucru-modelling.github.io/serosv/reference/compute_ci.age_time_model.md)
  : Compute confidence interval for time age model
- [`compute_ci.hierarchical_bayesian_model()`](https://oucru-modelling.github.io/serosv/reference/compute_ci.hierarchical_bayesian_model.md)
  : Compute 95% credible interval for hierarchical Bayesian model
- [`find_best_fp_powers()`](https://oucru-modelling.github.io/serosv/reference/find_best_fp_powers.md)
  : Returns the powers of the GLM fitted model which has the lowest
  deviance score.

# Articles

### Fitting data

- [Input
  data](https://oucru-modelling.github.io/serosv/articles/linelisting_vs_aggregated.md):
- [SIR
  model](https://oucru-modelling.github.io/serosv/articles/sir_model.md):
- [Parametric
  models](https://oucru-modelling.github.io/serosv/articles/parametric_model.md):
- [Nonparametric
  model](https://oucru-modelling.github.io/serosv/articles/nonparametric_model.md):
- [Semiparametric
  model](https://oucru-modelling.github.io/serosv/articles/semiparametric_model.md):
- [Modeling directly from antibody
  levels](https://oucru-modelling.github.io/serosv/articles/model_quantitative_data.md):
- [Model repeated cross-sectional
  data](https://oucru-modelling.github.io/serosv/articles/repeated_cross_sectional.md):

### Utilities

- [Data
  transformation](https://oucru-modelling.github.io/serosv/articles/data_transformation.md):
- [Imperfect serological
  test](https://oucru-modelling.github.io/serosv/articles/imperfect_test.md):
- [Model
  visualization](https://oucru-modelling.github.io/serosv/articles/visualizing_model.md):
- [Model
  selection](https://oucru-modelling.github.io/serosv/articles/model_selection.md):
